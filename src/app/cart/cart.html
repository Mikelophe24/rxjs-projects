<div class="cart-container">
  <h1>ğŸ›’ RxJS Shopping Cart</h1>

  <div class="cart-layout">
    <!-- Available Products Section -->
    <div class="products-section">
      <h2>ğŸ“¦ Available Products</h2>
      <div class="product-list">
        <div class="product-card" *ngFor="let product of availableProducts">
          <div class="product-info">
            <div class="product-name">{{ product.name }}</div>
            <div class="product-price">${{ product.price }}</div>
          </div>
          <button class="btn btn-add" (click)="addToCart(product)">â• Add</button>
        </div>
      </div>
    </div>

    <!-- Shopping Cart Section -->
    <div class="cart-section">
      <div class="cart-header">
        <h2>ğŸ›ï¸ Your Cart</h2>
        <div class="cart-summary">
          <span class="item-count">{{ (totalItems$ | async) || 0 }} items</span>
          <span class="total-price">${{ (totalPrice$ | async) || 0 }}</span>
        </div>
      </div>

      <!-- Cart Items -->
      <div class="cart-items" *ngIf="(cartItems$ | async)?.length; else emptyCart">
        <div class="cart-item" *ngFor="let item of cartItems$ | async">
          <div class="item-details">
            <div class="item-name">{{ item.product.name }}</div>
            <div class="item-price">${{ item.product.price }} Ã— {{ item.quantity }}</div>
          </div>

          <div class="item-controls">
            <button class="btn-control" (click)="decreaseQuantity(item.product.id)">â–</button>
            <span class="quantity">{{ item.quantity }}</span>
            <button class="btn-control" (click)="increaseQuantity(item.product.id)">â•</button>
            <button class="btn-remove" (click)="removeFromCart(item.product.id)">ğŸ—‘ï¸</button>
          </div>

          <div class="item-total">${{ item.product.price * item.quantity }}</div>
        </div>

        <!-- Cart Actions -->
        <div class="cart-actions">
          <button class="btn btn-clear" (click)="clearCart()">ğŸ—‘ï¸ Clear Cart</button>
          <div class="final-total">
            <span>Total:</span>
            <span class="amount">${{ (totalPrice$ | async) || 0 }}</span>
          </div>
        </div>
      </div>

      <!-- Empty Cart Message -->
      <ng-template #emptyCart>
        <div class="empty-cart">
          <div class="empty-icon">ğŸ›’</div>
          <p>Your cart is empty</p>
          <p class="empty-hint">Add some products to get started!</p>
        </div>
      </ng-template>
    </div>
  </div>

  <!-- RxJS Info -->
  <div class="info-box">
    <h3>ğŸ”§ RxJS Operators Used:</h3>
    <ul>
      <li><code>merge</code> - Káº¿t há»£p nhiá»u action streams thÃ nh má»™t</li>
      <li><code>scan</code> - Accumulate state nhÆ° reducer (Redux pattern)</li>
      <li><code>withLatestFrom</code> - Láº¥y state hiá»‡n táº¡i khi action xáº£y ra</li>
      <li><code>map</code> - Transform data vÃ  tÃ­nh toÃ¡n derived state</li>
    </ul>

    <h3>ğŸ“š State Management Concepts:</h3>
    <ul>
      <li><strong>Actions:</strong> ADD, REMOVE, UPDATE_QUANTITY</li>
      <li><strong>Reducer:</strong> Pure function xá»­ lÃ½ state transitions</li>
      <li><strong>Derived State:</strong> totalPrice$ vÃ  totalItems$ tá»± Ä‘á»™ng tÃ­nh tá»« cart state</li>
      <li><strong>Immutability:</strong> LuÃ´n táº¡o object má»›i thay vÃ¬ mutate</li>
    </ul>
  </div>
</div>
